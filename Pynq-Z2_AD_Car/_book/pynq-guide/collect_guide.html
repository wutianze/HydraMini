
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Collect Data Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="run_guide.html" />
    
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" >
            
                <span>
            
                    
                    [Pynq Part]
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="1.2.1" data-path="collect_guide.html">
            
                <a href="collect_guide.html">
            
                    
                    Collect Data
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="run_guide.html">
            
                <a href="run_guide.html">
            
                    
                    Run the Car
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" >
            
                <span>
            
                    
                    [Host Part]
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../host-guide/dnndk_usage.html">
            
                <a href="../host-guide/dnndk_usage.html">
            
                    
                    DNNDK Usage
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../host-guide/train_compile.html">
            
                <a href="../host-guide/train_compile.html">
            
                    
                    Train & Compile
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../virtual-guide/">
            
                <a href="../virtual-guide/">
            
                    
                    Virtual Part
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../virtual-guide/custom_simulator.html">
            
                <a href="../virtual-guide/custom_simulator.html">
            
                    
                    Custom Simulator
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Collect Data</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <!--
 * @Author: Sauron Wu
 * @GitHub: wutianze
 * @Email: 1369130123qq@gmail.com
 * @Date: 2019-10-14 14:57:47
 * @LastEditors: Sauron Wu
 * @LastEditTime: 2019-10-17 14:48:18
 * @Description: 
 -->
<h1 id="what-you-will-learn">What you will learn:</h1>
<ul>
<li>How to collect training data.</li>
<li>How to define your own controller.</li>
</ul>
<h1 id="how-to-use">How to use</h1>
<h2 id="step-1">Step 1:</h2>
<p>Do some preparations. ini.sh will help you load the dpu.ko and set X11.</p>
<pre><code class="lang-shell">cd ~/Car
su
chmod +x ./ini.sh
./ini.sh
</code></pre>
<h2 id="step2">Step2:</h2>
<p>Compile the code and try.</p>
<pre><code class="lang-shell">make collect
./build/collect 50000 # 50000 means how many pictures you need to collect
</code></pre>
<p>Now you will see a small window in your PC and you can use your keyboard to control your car:</p>
<ul>
<li>w: move forward</li>
<li>a: turn left</li>
<li>d: turn right</li>
<li>s: stop</li>
<li>t: start to save images until the number of pictures reach the threshold you set before</li>
<li>Esc: stop the whole process
The pictures and labels are saved in the directory <code>images</code>.</li>
</ul>
<h1 id="define-your-own-controller">Define your own controller</h1>
<h2 id="1-modify-the-labels-you-want-to-save">1. Modify the labels you want to save</h2>
<p>In <code>src/control.h&amp;control.cc</code>, you can see the current controller class PYNQZ2, the function <code>to_record</code> will return a string which will be written as labels. PYNQZ2 controller will store the throttle value and steer value of the car currently. You can replace the function content by your own to store other information.<br><strong><em>Tip: The label file&apos;s format is csv which means values should be separated by &apos;,&apos;</em></strong></p>
<h2 id="2-modify-the-keyboard-settings">2. Modify the keyboard settings</h2>
<p>You can choose a more comfortable way to play the car. The function you need to change in this part is in <code>collect.cc/main</code>. You will see a <code>switch(c)</code> in <code>main</code>, read the code and I&apos;m sure you can define your own settings quickly.  </p>
<h1 id="pynq-control-api">Pynq-Control API</h1>
<ol>
<li>void throttleSet(float)</li>
<li>Set the throttle value of the car. The value range from -1.0 to 1.0. 0 means stop, &gt; 0.0 means forward and &lt; 0.0 means backward. The third led will be lighted.</li>
<li>void steerSet(float)</li>
<li>Set the steer value of the car. The value range from -1.0 to 1.0. 0 means straight forward, &gt; 0.0 means right and &lt; 0.0 means left. The fourth led will be lighted.</li>
<li>void throttleChange(float)</li>
<li>Add to the throttle value of the car. The max of input value is 1.0 and the min is -1.0. The first and third leds will be lighted.</li>
<li>void steerChange(float)</li>
<li>Add to the steer value of the car. The max of input value is 1.0 and the min is -1.0. The second and fourth leds will be lighted.</li>
<li>PYNQZ2::Status* getStatus()</li>
<li>Return the current Status of the car. It contains the current throttle and steer value of the car. You can use it like <code>PYNQZ2::Status* s = controller.getStatus(); float nowThrottle = s-&gt;throttleRate; float nowSteer = s-&gt;steerRate;</code></li>
<li>string to_record()</li>
<li>This function can generate a piece of info describing the current status of the car in .csv format. Example return: <code>0.1,0.5</code>, 0.1 is the steer value and 0.5 is the throttle value. It seems that the car is moving right forward now.</li>
</ol>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                
                <a href="run_guide.html" class="navigation navigation-next navigation-unique" aria-label="Next page: Run the Car">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Collect Data","level":"1.2.1","depth":2,"next":{"title":"Run the Car","level":"1.2.2","depth":2,"path":"pynq-guide/run_guide.md","ref":"pynq-guide/run_guide.md","articles":[]},"previous":{"title":"[Pynq Part]","level":"1.2","depth":1,"ref":"","articles":[{"title":"Collect Data","level":"1.2.1","depth":2,"path":"pynq-guide/collect_guide.md","ref":"pynq-guide/collect_guide.md","articles":[]},{"title":"Run the Car","level":"1.2.2","depth":2,"path":"pynq-guide/run_guide.md","ref":"pynq-guide/run_guide.md","articles":[]}]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":["livereload"],"pluginsConfig":{"livereload":{},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"pynq-guide/collect_guide.md","mtime":"2019-10-24T02:39:38.371Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2019-10-25T09:50:32.052Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-livereload/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

